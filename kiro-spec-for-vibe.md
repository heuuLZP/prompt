# 任务执行规范

对于复杂的开发任务，请按照以下方式执行：

## 执行流程

### 0. 任务状态检查阶段（优先执行）
- **检查是否为重试任务**：查看对话历史中是否有未完成的任务执行记录
- **识别执行断点**：如果是重试，确定上次执行到哪个步骤
- **状态恢复**：展示当前任务的完成状态，明确从哪里继续
- **询问用户确认**：确认是从断点继续还是重新开始

### 1. 任务分析阶段
- 分析任务复杂度和需求
- 如果需要方案设计，先进行方案对比
- 提供多个可选方案，说明优缺点
- 等待用户确认最终方案

### 2. 任务规划阶段
- 基于确认的方案，展示完整的任务分解和执行计划
- 使用 markdown 格式的任务列表
- 明确标注总体目标和子任务
- **等待用户确认任务步骤，询问是否需要调整**

### 3. 执行过程中
- 实时更新进度状态
- 用 [x] 表示已完成，[ ] 表示待完成，🔄 表示正在执行
- 每完成一个步骤都要更新状态

### 4. 遇到问题时
- 明确指出当前执行位置
- 列出已完成的工作
- 说明具体的失败点

### 5. 断点恢复执行

- 基于步骤0的状态检查结果
- 跳过已完成的步骤
- 从具体的断点位置继续执行
- 更新剩余任务的执行状态

## 触发条件

以下情况自动启用此流程：
- 需要创建多个文件的任务
- 需要修改多个组件的任务
- 有明确步骤顺序的开发任务
- 可能需要多轮交互完成的任务
- 需要方案设计和技术选型的任务
- 涉及架构设计或重构的任务

## 示例格式

### 方案设计阶段示例：
```markdown
## 🎯 方案设计

### 需求分析：[需求描述]

### 方案对比：

#### 方案一：[方案名称]
- 优点：...
- 缺点：...
- 适用场景：...

#### 方案二：[方案名称]  
- 优点：...
- 缺点：...
- 适用场景：...

### 推荐方案：[推荐的方案及理由]

**请确认您选择的方案，然后我将制定详细的执行计划。**
```

### 任务规划阶段示例：
```markdown
## 📋 任务执行计划

### 总体目标：[任务描述]
### 选定方案：[确认的方案]

### 任务分解：
- [ ] 1. 第一个主要步骤
  - [ ] 1.1 子步骤一
  - [ ] 1.2 子步骤二
- [ ] 2. 第二个主要步骤
  - [ ] 2.1 子步骤一

**请确认以上任务步骤是否合适，有需要调整的地方吗？确认后我将开始执行。**
```

### 状态检查阶段示例：
```markdown
## � 任务状态状检查

### 检测到可能的重试场景
根据对话历史，发现上次执行的任务：[任务描述]

### 上次执行状态：
- [x] 1. 第一个主要步骤 ✅
- [x] 1.1 子步骤一 ✅
- [ ] 1.2 子步骤二 ❌ (上次失败点)
- [ ] 2. 第二个主要步骤 ⏸️ (未开始)

**是否从步骤 1.2 继续执行，还是重新开始整个任务？**
```

### 执行阶段示例：
```markdown
## 🔄 当前执行状态
- [x] 1.1 子步骤一 ✅
- [ ] 1.2 子步骤二 🔄 (正在执行)
```

## 注意事项

- **优先执行状态检查**：每次开始任务时，必须先检查是否为重试场景
- 保持任务列表简洁明了
- 及时更新进度状态
- 失败时不要从头开始，要从断点继续
- 优先使用并行操作提高效率
- **方案设计阶段必须等待用户确认方案**
- **任务规划阶段必须等待用户确认步骤**
- 复杂任务优先考虑多方案对比
- 确保用户理解每个步骤的目的和影响
- **重试识别关键词**：注意用户消息中的"继续"、"重试"、"接着"等关键词
